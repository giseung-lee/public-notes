<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Javascript 실행 과정 및 비동기 &middot; 이기승의 끄적끄적..
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
<link rel="stylesheet" href="/public/css/ntz4kiseung.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- Profile -->
  <div class="sidebar-item sidebar-profile-box">
    <img class="sidebar-profile-image" src="/public/image/About Me/sidebar_profile.png" >
    <div class="sidebar-profile-description">
      <span>
        &nbsp;잡기에 능한 개발자입니다. 잡기보다 개발 실력이 좋아야 할 텐데 걱정입니다.
      </span>
    </div>
  </div>
  <!-- Profile End -->

  <nav class="sidebar-nav">
    <!-- Home -->
    <a class="sidebar-nav-item" href="/">Home</a>
    <!-- Home End -->
    <!-- Posts -->
    
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/About Me">About Me</a>
      
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/Daily Thoughts">Daily Thoughts</a>
      
    
      
        <input id="Projects" class="toggle" type="checkbox">
        <label for="Projects" class="lbl-toggle sidebar-nav-item" tabindex="0">Projects</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Sagyo_Reboot">Sagyo_Reboot</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Twitch_Chat_Analysis">Twitch_Chat_Analysis</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Hwangmaesan">Hwangmaesan</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/The_Oyster_Mine">The_Oyster_Mine</a>
          
        
        </div>
      
    
      
        <input id="Study" class="toggle" type="checkbox">
        <label for="Study" class="lbl-toggle sidebar-nav-item" tabindex="0">Study</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Short_Books">Short_Books</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Http The Definitive Guide">Http The Definitive Guide</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/C_Kim_Pope">C_Kim_Pope</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/MSA_Ken_Krueger">MSA_Ken_Krueger</a>
          
        
        </div>
      
    
      
        <input id="Googling" class="toggle" type="checkbox">
        <label for="Googling" class="lbl-toggle sidebar-nav-item" tabindex="0">Googling</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/etc">etc</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/java">java</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/jekyll">jekyll</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/linux">linux</a>
          
        
        </div>
      
    
    <!-- Posts End -->
  </nav>

  <!-- sidebar bottom -->
  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
  <!-- sidebar bottom end -->
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title" style="font-weight: normal;">
            <a href="/" title="Home">이기승의 끄적끄적..</a>
            <small>개발 및 잡다한 포스팅</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Javascript 실행 과정 및 비동기</h1>
  <span class="post-date">15 May 2020</span>
  
<ul>
  <li>본 포스팅은 아래의 글을 참고했습니다.
    <ul>
      <li><a href="https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf">https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf</a></li>
      <li><a href="https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e">https://blog.sessionstack.com/how-javascript-works-inside-the-v8-engine-5-tips-on-how-to-write-optimized-code-ac089e62b12e</a></li>
      <li><a href="https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5">https://blog.sessionstack.com/how-javascript-works-event-loop-and-the-rise-of-async-programming-5-ways-to-better-coding-with-2f077c4438b5</a></li>
    </ul>
  </li>
</ul>

<h2 id="javascript-엔진">Javascript 엔진</h2>

<hr />

<ul>
  <li>
    <p>자바스크립트 엔진이란 자바스크립트 코드를 해석하고 실행하는 프로그램 또는 인터프리터입니다. (다른 언어에선 컴파일러, 인터프리터라고 부르는데 왜 자바스크립트에선 엔진이라 부르는지는 모르겠습니다..)</p>
  </li>
  <li>
    <p>자바스크립트 엔진은 대부분 웹 브라우저, Node JS에서 실행됩니다. (물론, 자바스크립트 엔진을 사용하는 다른 프로그램들도 있습니다.)</p>
  </li>
  <li>
    <p>자바스크립트 엔진에 따라 구현하는 ECMAScript의 버전이 다릅니다. (흔히 말하는 ES6, ES7, ES8…)</p>
  </li>
  <li>
    <p>유명한 자바스크립트 엔진엔 다음과 같은 것들이 있습니다.</p>

    <ul>
      <li>V8 : 구글에서 개발, 크롬, NodeJS에서 사용중.</li>
      <li>Rhino : 모질라재단에서 개발</li>
      <li>SpiderMonkey : 최초의 자바스크립트 엔진, 파이어폭스에서 사용중</li>
      <li>Chakra(JScript9) : 인터넷익스플로러에서 사용</li>
      <li>Chakra(Javascript) : 마이크로소프트 엣지에서 사용</li>
      <li>Jerryscript : IoT 에서 많이 사용</li>
    </ul>
  </li>
</ul>

<h2 id="v8">V8</h2>

<hr />

<ul>
  <li>대부분 엔진은 비슷하게 동작하지만, 엔진마다 다소간의 차이가 있으므로 현재 가장 유명한 엔진인 V8엔진을 알아보겠습니다.</li>
</ul>

<h3 id="구성요소">구성요소</h3>

<p class="p_img"><img src="/public/image/etc/v8-engine.png" alt="v8-engine.png" /><small>출처 : https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf</small></p>

<ul>
  <li>V8 엔진은 위와 같이 두 부분으로 이루어집니다.
    <ul>
      <li>메모리 힙(Memory Heap) : 다른 언어들의 힙 메모리 처럼 메모리 할당이 이루어집니다.</li>
      <li>콜 스택(Call Stack) : 다른 언어들의 스택 메모리 처럼 함수의 스택 프레임이 쌓입니다.</li>
    </ul>
  </li>
  <li>그런데, 우리가 실제로 자바스크립트를 이용할 땐 V8 엔진만 가지고 동작하는 것은 아닙니다.</li>
</ul>

<p class="p_img"><img src="/public/image/etc/v8-engine-web-api.png" alt="v8-engine-web-api.png" /><small>출처 : https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf</small></p>

<ul>
  <li>DOM, AJAX(XMLHttpRequest), Timeout과 같이 자바스크립트를 사용하면 반드시 마주치게 되는 것들이 브라우저의 Web API에서 지원되는 것들입니다. Web API에 대한 자세한 사항은 <a href="https://developer.chrome.com/apps/api_other">크롬의 Web API 문서</a>를 참조해주세요.</li>
  <li>Event Loop와 Callback Queue는 뒤에서 살펴볼 자바스크립트의 비동기에 있어 필수적인 것입니다.</li>
</ul>

<h3 id="call-stack">Call Stack</h3>

<ul>
  <li>자바스크립트는 싱글 스레드 언어라는 말을 들어보셨을 겁니다. 대부분 언어에서 한 스레드당 하나의 스택 메모리를 할당 받는데, 자바스크립트는 오직 하나의 콜 스택을 갖습니다. 때문에, 자바스크립트를 싱글 스레드 언어라고 부릅니다.</li>
  <li>콜 스택의 작동방식은 다른 언어의 스택 메모리와 크게 다르지 않습니다.</li>
</ul>

<h2 id="javascript-비동기">Javascript 비동기</h2>

<hr />

<ul>
  <li>비동기 방식은 한 개의 작업을 기다리는 동안 다른 작업을 수행할 수 있는것입니다. 그런데 스택 메모리가 1개인데 어떻게 한개를 기다리며 다른 작업을 할 수 있을까요?</li>
  <li>Web API와 Callback Queue, Event Loop를 통해 가능합니다.
    <ul>
      <li>Web API는 앞서 말했듯이 브라우저 차원에서 지원해주는 SetTimeOut, DOM 같은 API입니다.</li>
      <li>Callback Queue는 onClick, onLoad, onDone과 같은 이벤트와 콜백 함수들이 저장되는 곳입니다.</li>
      <li>Event Loop는 JS의 Call Stack과 브라우저의 Callback Queue를 감시하고 있다가 Call Stack이 비었을 때 Callback Queue에 있는 작업을 Call Stack에 옮깁니다.</li>
    </ul>
  </li>
</ul>

<p class="p_img"><img src="/public/image/etc/v8-engine-web-api.png" alt="v8-engine-web-api.png" /><small>출처 : https://blog.sessionstack.com/how-does-javascript-actually-work-part-1-b0bacc073cf</small></p>

<ul>
  <li>자바스크립트가 싱글스레드라는 것은 위 그림에서 JS의 Call Stack이 하나라는 것입니다. Web API는 별도의 스레드를 가지고 있습니다.</li>
  <li>비동기 작업(SetTimeOut이나 외부 API 호출 등..)은 Web API의 스레드로 옮겨집니다.</li>
  <li>작업이 끝나고 이후의 작업을 할 준비가 됐다면 Callback Queue로 옮겨집니다.</li>
  <li>Event Loop가 Call Stack을 보고있다가 Callback Queue의 콜백 함수를 Call Stack에 옮겨줍니다.</li>
  <li><a href="http://latentflip.com/loupe/?code=JC5vbignYnV0dG9uJywgJ2NsaWNrJywgZnVuY3Rpb24gb25DbGljaygpIHsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gdGltZXIoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ1lvdSBjbGlja2VkIHRoZSBidXR0b24hJyk7ICAgIAogICAgfSwgMjAwMCk7Cn0pOwoKY29uc29sZS5sb2coIkhpISIpOwoKc2V0VGltZW91dChmdW5jdGlvbiB0aW1lb3V0KCkgewogICAgY29uc29sZS5sb2coIkNsaWNrIHRoZSBidXR0b24hIik7Cn0sIDUwMDApOwoKY29uc29sZS5sb2coIldlbGNvbWUgdG8gbG91cGUuIik7!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D">latentflip</a>에서 코드의 진행에 따라 각 메모리가 어떻게 변하는 지 확인할 수 있습니다.</li>
</ul>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/posts/googling/etc/index/">
            DB 인덱스 관련(작성중)
            <small>08 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/googling/etc/Hash/">
            해시관련 정리
            <small>07 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/daily%20thoughts/%ED%95%99%EC%8A%B5%EB%B0%A9%ED%96%A5/">
            Line 면접 및 학습 방향에 대한 고민
            <small>06 Jun 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
