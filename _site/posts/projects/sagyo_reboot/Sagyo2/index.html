<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      프로젝트 디렉토리 구조 정리 - 사전조사 &middot; 이기승의 끄적끄적..
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
<link rel="stylesheet" href="/public/css/ntz4kiseung.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- Profile -->
  <div class="sidebar-item sidebar-profile-box">
    <img class="sidebar-profile-image" src="/public/image/About%20Me/sidebar_profile.png">
    <div class="sidebar-profile-description">
      <span>
         잡기에 능한 개발자입니다. 잡기보다 개발 실력이 좋아야 할 텐데 걱정입니다.
      </span>
    </div>
  </div>
  <!-- Profile End -->

  <nav class="sidebar-nav">
    <!-- Home -->
    <a class="sidebar-nav-item" href="/">Home</a>
    <!-- Home End -->
    <!-- Posts -->
    
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/About%20Me">About Me</a>
      
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/Daily%20Thoughts">Daily Thoughts</a>
      
    
      
        <input id="Projects" class="toggle" type="checkbox">
        <label for="Projects" class="lbl-toggle sidebar-nav-item" tabindex="0">Projects</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Sagyo_Reboot">Sagyo_Reboot</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Twitch_Chat_Analysis">Twitch_Chat_Analysis</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Hwangmaesan">Hwangmaesan</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/The_Oyster_Mine">The_Oyster_Mine</a>
          
        
        </div>
      
    
      
        <input id="Study" class="toggle" type="checkbox">
        <label for="Study" class="lbl-toggle sidebar-nav-item" tabindex="0">Study</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Short_Books">Short_Books</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Http%20The%20Definitive%20Guide">Http The Definitive Guide</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/C_Kim_Pope">C_Kim_Pope</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/MSA_Ken_Krueger">MSA_Ken_Krueger</a>
          
        
        </div>
      
    
      
        <input id="Googling" class="toggle" type="checkbox">
        <label for="Googling" class="lbl-toggle sidebar-nav-item" tabindex="0">Googling</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/etc">etc</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/java">java</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/jekyll">jekyll</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/linux">linux</a>
          
        
        </div>
      
    
    <!-- Posts End -->
  </nav>

  <!-- sidebar bottom -->
  <div class="sidebar-item">
    <p>
      © 2020. All rights reserved.
    </p>
  </div>
  <!-- sidebar bottom end -->
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title" style="font-weight: normal;">
            <a href="/" title="Home">이기승의 끄적끄적..</a>
            <small>개발 및 잡다한 포스팅</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">프로젝트 디렉토리 구조 정리 - 사전조사</h1>
  <span class="post-date">18 Apr 2020</span>
  
<ul>
  <li> 프로젝트를 진행할 때도 너무 꼴 뵈기 싫었지만, 당시 프로젝트는 하루 하루가 소중했기 때문에 디렉토리 구조를 바꿀 엄두를 못냈습니다.
    <h2 id="1-현재-디렉토리-구조">1. 현재 디렉토리 구조</h2>
  </li>
</ul>

<hr>

<p class="p_img"><img src="/public/image/Sagyo_Reboot/dir_now.png" alt="dir_now.png" width="50%"></p>

<ul>
  <li> 한 폴더 안에 DAO, DTO, Controller, Service 모두 있는 것도 이해가 안되지만, 그 한 폴더가 왜 test.mybatis인지는… 왜 그랬을까요?</li>
</ul>

<p class="p_img"><img src="/public/image/Sagyo_Reboot/dir_now2.png" alt="dir_now2.png" width="50%"></p>

<ul>
  <li> WebContent는 그나마 나은 편이지만 jsp 파일도 조금 분리할 필요가 있는 것 같습니다.</li>
</ul>

<h2 id="2-목표-디렉토리-구조">2. 목표 디렉토리 구조</h2>

<hr>

<ul>
  <li>
    <p> 디렉토리 구조를 개편하기 위해 어떤 방식의 구조를 많이 쓰나 찾아봤습니다. 우선, 공식 문서 같은 곳에서 추천하는 구조는 따로 없었습니다.</p>
  </li>
  <li>
    <p> 예전에 실무에서 썼던 구조가 직관적으로 사용하기 편하고, 구글링 해보니 해당 구조를 따르는 사람들도 꽤 있는 것 같아 그 구조를 가져오기로 했습니다.</p>
  </li>
  <li>
    <p> 업무별로 크게 나눈 다음, 각 업무별로 DAO, DTO, Service, Web(Controller)를 만드는 구조입니다.</p>

    <div class="highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>com
 └ Sagyo
     └ user
         └ DAO
         └ VO(DTO)
         └ Service
              └ ServiceImpl
         └ Web(Controller)
     └ post
         └ DAO
         └ VO(DTO)
         └ Service
              └ ServiceImpl
         └ Web(Controller)
           
           :
           
     └ cs
         └ DAO
         └ VO(DTO)
         └ Service
              └ ServiceImpl
         └ Web(Controller)
     └ common
          └ util
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="3-의문점">3. 의문점</h2>

<hr>

<ul>
  <li> 그런데 프로젝트 구조를 생각하다 보니 몇 가지 의문점들이 생겼습니다.</li>
</ul>

<h3 id="31-dao와-service의-차이점">3.1. DAO와 Service의 차이점</h3>

<ul>
  <li> 이 부분은 Sagyo 프로젝트를 할 때는 몰랐고, 현업에 나갔을 때 들었던 의문입니다.</li>
  <li> 현업에서 위와 같이 DAO, Service, ServiceImpl을 따로 관리하고 있었는데, 실제 소스를 보면 3개의 역할이 동일한 것이었습니다.
    <ul>
      <li> Service 인터페이스는 구현체인 ServiceImpl 클래스와 1:1 대응되고 있고, DAO의 각 메서드는 ServiceImpl의 메서드들과 1:1 대응하고 있었습니다.</li>
      <li> 당시 이 부분을 여쭤보고 싶었지만 프로젝트 분위기가 살벌했기에 물어볼 엄두가 안났습니다.</li>
    </ul>
  </li>
  <li> 구글링 해보니 DAO와 Service에 대한 논의가 많았습니다. 글들을 간단히 요약하면 다음과 같습니다.
    <ul>
      <li> DAO는 테이블의 CRUD 같이 작은 단위의 DB 접근</li>
      <li> Service는 비즈니스 로직 단위의 트랜잭션. DAO들의 집합, 조합.</li>
    </ul>
  </li>
  <li> 예를들어, 게시글을 눌렀을 때 글쓴이의 프로필, 글 내용, 댓글이 보이는 게시판이 있다고 가정합시다.
    <ul>
      <li> 이때 DAO는 ‘프로필 조회’, ‘글 조회’, ‘조회수 증가’, ‘댓글 조회’ 같이 4개의 DAO 메서드가 필요합니다.</li>
      <li> 이 4개의 작업이 게시글 조회라는 한 트랜잭션 안에 일어나야 하기 때문에 Service에는 1개의 메서드가 필요한 것입니다.</li>
    </ul>
  </li>
  <li>
    <p> 그런데 지금 Sagyo 프로젝트에선 DAO의 인터페이스를 만들고, MyBatis의 SqlSessionTemplate을 이용해 DAO 인터페이스를 구현하는 방식으로 구성되어 있습니다. CRUD중 CRD는 한 쿼리에서 한 테이블을 건드리니 상관 없지만 Read 같은 경우 여러 테이블을 붙여 아래와 같은 쿼리가 나오게 됐습니다.</p>

    <div class="language-sql highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span>
<span class="p">(</span>
  <span class="k">SELECT</span> <span class="n">POSTID</span><span class="p">,</span> <span class="n">USERID</span><span class="p">,</span> <span class="n">NICKNAME</span><span class="p">,</span> <span class="n">TITLE</span><span class="p">,</span> <span class="n">CONTENTS</span><span class="p">,</span> <span class="n">MEETDATE</span><span class="p">,</span> <span class="n">ADDRSINAME</span><span class="p">,</span> <span class="n">ADDRGUNAME</span><span class="p">,</span> <span class="n">URL</span><span class="p">,</span> <span class="n">URLBAD</span>
  <span class="k">FROM</span> <span class="n">POST_VIEW</span>
  <span class="k">WHERE</span> <span class="n">MEETDATE</span><span class="o">&gt;=</span><span class="n">SYSDATE</span>
    <span class="k">AND</span> <span class="n">FN_POST_IS_ACCEPTED</span><span class="p">(</span><span class="n">POSTID</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">AND</span> <span class="n">INTERMAINID</span><span class="o">=</span><span class="p">(</span><span class="k">SELECT</span> <span class="n">INTERMAINID</span>
   <span class="k">FROM</span>
      <span class="p">(</span>
         <span class="k">SELECT</span> <span class="n">IM</span><span class="p">.</span><span class="n">INTERMAINID</span><span class="p">,</span> <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">))</span> <span class="k">AS</span> <span class="n">RANK</span>
           <span class="k">FROM</span> <span class="n">POST</span> <span class="n">P</span> <span class="k">JOIN</span> <span class="n">INTEREST_SUB</span> <span class="nv">"IS"</span> <span class="k">ON</span> <span class="n">P</span><span class="p">.</span><span class="n">INTERSUBID</span><span class="o">=</span><span class="nv">"IS"</span><span class="p">.</span><span class="n">INTERSUBID</span>
                       <span class="k">JOIN</span> <span class="n">INTEREST_MAIN</span> <span class="n">IM</span> <span class="k">ON</span> <span class="nv">"IS"</span><span class="p">.</span><span class="n">INTERMAINID</span><span class="o">=</span><span class="n">IM</span><span class="p">.</span><span class="n">INTERMAINID</span>
          <span class="k">WHERE</span> <span class="n">P</span><span class="p">.</span><span class="n">MEETDATE</span><span class="o">&gt;=</span><span class="n">SYSDATE</span>
          <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">IM</span><span class="p">.</span><span class="n">INTERMAINID</span>
          <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">))</span>
       <span class="p">)</span>
  <span class="k">WHERE</span> <span class="n">ROWNUM</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">MEETDATE</span> <span class="k">DESC</span>
<span class="p">)</span>
<span class="k">WHERE</span> <span class="n">ROWNUM</span> <span class="o">&lt;=</span><span class="mi">5</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p> 그리고 Service의 존재를 모르던 저희는 Service가 해야할 일을 Controller에 시켜버렸고 Controller에선 아래와 같은 일이 벌어졌습니다.</p>

    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"/opbadge.action"</span><span class="o">,</span> <span class="n">method</span><span class="o">=</span><span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">String</span> <span class="nf">opBadgeList</span><span class="o">(</span><span class="nc">Model</span> <span class="n">model</span><span class="o">,</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">)</span>
<span class="o">{</span>
    <span class="nc">IBadgeDAO</span> <span class="n">dao</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">IBadgeDAO</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="nc">IUserDAO</span> <span class="n">dao2</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="nc">IUserDAO</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList1"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList1</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList1_count"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList1_count</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList1_date"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList1_date</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
  
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList2"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList2</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList3"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList3</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"BadgeList4"</span><span class="o">,</span><span class="n">dao</span><span class="o">.</span><span class="na">BadgeList4</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
  
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"MyPageBad"</span><span class="o">,</span><span class="n">dao2</span><span class="o">.</span><span class="na">MyPageBad</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"myPageList"</span><span class="o">,</span> <span class="n">dao2</span><span class="o">.</span><span class="na">myPageList</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"myPageAddrList"</span><span class="o">,</span> <span class="n">dao2</span><span class="o">.</span><span class="na">myPageAddrList</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"myPageInterList"</span><span class="o">,</span> <span class="n">dao2</span><span class="o">.</span><span class="na">myPageInterList</span><span class="o">(</span><span class="n">userId</span><span class="o">));</span>
  
    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">"userId"</span><span class="o">,</span> <span class="n">userId</span><span class="o">);</span>
  
    <span class="k">return</span> <span class="s">"WEB-INF/views/OpBadge.jsp"</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li> 어쩐지 코드 작성하면서도 ‘Controller는 간단하게 구성된다는데…?’ 라는 의문이 들었습니다. 또, ‘DAO Service 차이’를 구글링 하는데 연관 검색어에 ‘Service Controller 차이’가 떠있었는데 역시 사람들은 거진 비슷한 실수를 하는구나 생각했습니다.</li>
</ul>

<h3 id="32-dto는-어느-단위로-분리해야-하는지">3.2. DTO는 어느 단위로 분리해야 하는지</h3>

<ul>
  <li> Sagyo 프로젝트를 진행할 때 DTO를 어떤 단위로 구성해야 하는 지도 의문이었습니다.</li>
  <li> 처음엔 DB 테이블 단위로 구성했는데, 정규화를 철저하게 해놓다보니 테이블과 1:1로 대응되는 DTO로는 업무를 처리하지 못했습니다.</li>
  <li> ‘게시글 DTO에 유저 id 하나만 넣을게’ , ‘게시글 DTO에 이미지 url 하나만 넣을게’ … 6명이 한 DTO를 공유하며 각자 필요한 속성들을 넣다보니 하나의 DTO가 비대해졌습니다.</li>
  <li> ‘기승아, 이 DTO 쓰면 이 DTO는 없어져도 되겠는데?’와 같은 질문도 나오기 시작했습니다. 시작은 엄연히 다른 DTO 였는데 속성 10개중 8~9개가 겹치는 DTO들이 생기고, 한 DTO가 다른 DTO를 포함하는 사태가 벌어졌습니다.
    <ul>
      <li>너도 나도 하나씩 추가하다 보니 가장 비대해져버린 게시글DTO입니다.</li>
    </ul>

    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PostDTO</span>
<span class="o">{</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiName</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrGuId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrGuName</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrDetail</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">interMainId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">interMainName</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">interSubId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">interSubName</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">interDetail</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">postDate</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">meetDate</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">samegender</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">drink</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">grade</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">moodName</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">contents</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">urlBad</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">url</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">nickname</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">telCertiId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">emailCertiId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">followId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">postId</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">minNum</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">maxNum</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">limitGrade</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">postStatus</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">num</span><span class="o">;</span>
      
    <span class="c1">// getter / setter</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li> 당시 웹 개발 프로젝트도 처음이고 시간도 촉박한 상황이라 방법론에 대해 고민할 시간이 없었습니다. 여유가 있었다면 팀원들에게 더 좋은 방법론을 제시해 줄 수 있었을 텐데 미안할 따름입니다.</li>
  <li> 그리고 이 DTO에 관한 고민은 아래 고민으로 이어지게 됩니다.</li>
</ul>

<h3 id="33-dto-방식과-map-방식">3.3. DTO 방식과 Map 방식</h3>

<ul>
  <li>
    <p> 당시 같이 프로젝트를 하던 다른 팀을 염탐하던 중 DTO 대신 Map을 쓰는 팀을 발견햤습니다. 팀에 Map을 도입시킨 친구는 이렇게 말했습니다. ‘너네도 DTO 쓰지말고 Map 써봐라, DTO 관리할 필요도 없고 새 프로퍼티 필요하면 그냥 쿼리에 쓰면 된다. Map관련해서 설정만 몇 가지 하면 되는데 금방한다.’</p>
  </li>
  <li>
    <p> 당시 DTO가 점점 비대해지는 이슈를 인지하고 있던터라 솔깃했습니다. 하지만, 프로젝트 중간에 방법론을 바꿨을 때의 리스크를 감당할 수 없었기 때문에 제안을 거절했습니다.</p>
  </li>
  <li>
    <p> 이후 실무에 나갔을 땐 DTO와 Map을 혼용해서 쓰고 있었습니다. 프로젝트 안에 딱히 코드 표준을 두지 않았기 때문에 개발자 A님은 DTO를 쓰고 있고 개발자 B님은 Map을 쓰고 있었습니다.</p>
  </li>
  <li>
    <p> 점심시간에 밥 먹으며 슬쩍 물어봤더니 다음과 같은 답이 돌아왔습니다. ‘예전엔 뭐 써야 된다 말이 많았는데, 요즘은 프로젝트 안에서 따로 정하지 않으면 개발자 개인 성향따라 간다. 둘 다 장단점이 있으니까 한 번 찾아봐라.’</p>
  </li>
  <li> 최근(2017년)에 핫한 토론이 벌어진 <a href="https://okky.kr/article/370609">okky 링크</a>를 첨부합니다. DTO파, Map파, 중도파 모두 있는 게시글인데 서로 충돌 지점이 없는 부분을 요약하면 다음과 같습니다.
    <ul>
      <li> 프로젝트 안에 표준이 있다면 그걸 따른다.</li>
      <li> Map : 생산성이 높다. 개발기간에 변경이 잦은 대한민국 SI 환경에 강하다. 그러나 다른 사람이 유지보수하기 힘들다.</li>
      <li> DTO : 시스템의 구조를 잘 보여준다. 다른 사람이 코드를 봐도 쉽게 이해할 수 있어 유지보수에 강하다.</li>
    </ul>
  </li>
  <li> 성능 부분에선 의견이 갈리는 것 같았습니다. 개인적으론 중도파를 선택하고 싶습니다.
    <ul>
      <li> CRUD중 CUD는 DTO와 DB 테이블을 일치 시키는 것도 용이하고, 타입에 관한 걱정도 해야하니 DTO를 쓰는게 맞는 것 같습니다.</li>
      <li> 여러 테이블을 붙여 불러올 때가 많고, 불러오는 속성이 자주 바뀌기도 하는 Read는 Map을 써도 되지 않을까 생각합니다.</li>
    </ul>
  </li>
  <li> 그런데 DTO vs Map을 찾아보던 중에 아래 의문이 생겼습니다.</li>
</ul>

<h3 id="34-vo와-dto는-같은-것인가">3.4. VO와 DTO는 같은 것인가</h3>

<ul>
  <li> 사실 이 부분은 깐깐하게 가르치던 강사님도 ‘거의 같은 개념으로 사용한다고 보시면 됩니다.’ 라며 넘어가던 주제입니다.(프로그래밍을 처음 배우던 학생들에겐 적합하지 않은 주제인 것 같긴 합니다.)</li>
  <li> 예전에 DTO를 Map으로도 쓸 수 있는 걸 알았을 땐 ‘아, DTO는 데이터를 옮겨주는 객체를 총칭하는 말이고, DTO안에 VO 방식과 Map방식이 있구나’라고 생각했지만, 구글링 해보니 DTO와 VO는 다른 개념인 것 같았습니다.</li>
  <li> 구글링 해본 결과 VO와 DTO의 정의와 사용을 명시한 공식 레퍼런스는 없고, 프로그래밍의 바이블 같은 서적들을 출처로 삼으며 ‘여기선 ~~라더라’는 정보들이 많았습니다.</li>
  <li> 공통적으로 나오는 특징들은 다음과 같습니다.
    <ul>
      <li> VO는 read only가 강한것, 주로 DB 테이블과 1:1로 대응됨(필수는 아님), 어플리케이션과 DB사이를 왔다갔다함.</li>
      <li> DTO는 비즈니스 로직 중심의 속성들로 구성됨, DB뿐 아니라 어플리케이션 안밖의 다른 레이어들끼리의 데이터 전송도 맡음</li>
    </ul>
  </li>
  <li> 사람들이 많이 언급하는 레퍼런스는 Martin Fowler의 『Patterns of Enterprise Application Architecture』 였습니다. <del>(인터넷에서 쉽게 pdf를 구할 수 있습니다.)</del>
    <ul>
      <li> Martin Fowler는 DTO와 VO가 확실히 다르다고 언급하고 있습니다.
        <blockquote>
          <p> Sadly recently I’ve seen the J2EE community [Alur et al.] use the term “value object” to mean Data Transfer Object, which has caused a storm in the teacup of the patterns community. This is just one of those clashes over names that happen all the time in this business.</p>

        </blockquote>
      </li>
    </ul>
  </li>
  <li> 한글 포스팅 중 깔끔하게 정리된 곳은 <a href="https://medium.com/webeveloper/entity-vo-dto-666bc72614bb">https://medium.com/webeveloper/entity-vo-dto-666bc72614bb</a> 이곳 인것 같습니다. (여기선 덤으로 Entity도 비교해줍니다!)</li>
</ul>

<h2 id="4-아이고-골이야">4. 아이고 골이야..</h2>

<hr>

<ul>
  <li> 단순히 프로젝트 파일만 옮기려고 시작한 작업이었는데 의문점들을 정리하다 보니 일이 커졌습니다.
    <ol>
      <li> VO를 사용해야할 곳에 DTO를 사용하고 있었습니다. DTO도 테이블 단위로 쪼개 VO로 만들어야 될 것 같습니다. VO로 표현하기 어려운 곳엔 Map을 사용해야 할 것 같습니다.</li>
      <li> Service가 할 일을 Controller가 하고 있었습니다. Controller에서 여러 DAO를 호출하던 걸 Service로 묶어야 겠습니다.</li>
      <li> 지금과 같은 ‘Controller - Service - DAO - DTO/VO’ 구조에서 Service 가 관습적으로 쓰이는 경우가 많고(기능이 단순해 Service로 묶을 필요 없거나 Sagyo처럼 Controller에서 Service 역할을 해버리기도 하고), 이를 대체하는 DDD 패턴 같은 것도 있고.. 역시 개발자의 길은 멀고 험하구나.. <img class="emoji" title=":sweat_smile:" alt=":sweat_smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f605.png" height="20" width="20">
</li>
    </ol>

    <p class="p_img"><img src="/public/image/Sagyo_Reboot/headache.jpg" alt="headache.jpg"><small> 1시간 안에 쓱싹 할 줄 있을 줄 알았는데…</small></p>
  </li>
  <li> 또 다른 걱정은 6명 분량의 어플리케이션을 혼자 수정해야 한다는 것입니다.<img class="emoji" title=":scream:" alt=":scream:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f631.png" height="20" width="20">
</li>
  <li> 한 편의 포스팅에 조사 및 수정을 다 담으려 했는데 포스팅이 길어져 두 편으로 나눠야겠습니다!</li>
</ul>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/posts/googling/etc/Hash/">
            해시관련 정리(90% 작성)
            <small>07 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/daily%20thoughts/%ED%95%99%EC%8A%B5%EB%B0%A9%ED%96%A5/">
            Line 면접 및 학습 방향에 대한 고민
            <small>06 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/projects/sagyo_reboot/Sagyo5/">
            Sagyo MSA 개편 2 - Spring Cloud Oauth2를 이용한 인증 서비스(작성중)
            <small>27 May 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
