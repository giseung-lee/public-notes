<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Sagyo MSA 개편 1 - common, contact 서비스 &middot; 이기승의 끄적끄적..
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
<link rel="stylesheet" href="/public/css/ntz4kiseung.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <!-- Profile -->
  <div class="sidebar-item sidebar-profile-box">
    <img class="sidebar-profile-image" src="/public/image/About Me/sidebar_profile.png" >
    <div class="sidebar-profile-description">
      <span>
        &nbsp;잡기에 능한 개발자입니다. 잡기보다 개발 실력이 좋아야 할 텐데 걱정입니다.
      </span>
    </div>
  </div>
  <!-- Profile End -->

  <nav class="sidebar-nav">
    <!-- Home -->
    <a class="sidebar-nav-item" href="/">Home</a>
    <!-- Home End -->
    <!-- Posts -->
    
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/About Me">About Me</a>
      
    
      
        <!-- 1 depth post -->
        <a class="sidebar-nav-item" href="http://localhost:4000/posts/Daily Thoughts">Daily Thoughts</a>
      
    
      
        <input id="Projects" class="toggle" type="checkbox">
        <label for="Projects" class="lbl-toggle sidebar-nav-item" tabindex="0">Projects</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Sagyo_Reboot">Sagyo_Reboot</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Twitch_Chat_Analysis">Twitch_Chat_Analysis</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/Hwangmaesan">Hwangmaesan</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Projects/The_Oyster_Mine">The_Oyster_Mine</a>
          
        
        </div>
      
    
      
        <input id="Study" class="toggle" type="checkbox">
        <label for="Study" class="lbl-toggle sidebar-nav-item" tabindex="0">Study</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Short_Books">Short_Books</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Algorithm">Algorithm</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/Http The Definitive Guide">Http The Definitive Guide</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/C_Kim_Pope">C_Kim_Pope</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Study/MSA_Ken_Krueger">MSA_Ken_Krueger</a>
          
        
        </div>
      
    
      
        <input id="Googling" class="toggle" type="checkbox">
        <label for="Googling" class="lbl-toggle sidebar-nav-item" tabindex="0">Googling</label>
        <div class="collapsible-content subcategories">
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/etc">etc</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/java">java</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/jekyll">jekyll</a>
          
        
          
            <!-- 2 depth post -->
            <a class="sidebar-nav-item" href="http://localhost:4000/posts/Googling/linux">linux</a>
          
        
        </div>
      
    
    <!-- Posts End -->
  </nav>

  <!-- sidebar bottom -->
  <div class="sidebar-item">
    <p>
      &copy; 2020. All rights reserved.
    </p>
  </div>
  <!-- sidebar bottom end -->
</div>

    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title" style="font-weight: normal;">
            <a href="/" title="Home">이기승의 끄적끄적..</a>
            <small>개발 및 잡다한 포스팅</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Sagyo MSA 개편 1 - common, contact 서비스</h1>
  <span class="post-date">07 May 2020</span>
  
<ul>
  <li>본격적으로 Monolithic구조의 Sagyo를 MSA로 개편하기 시작했습니다. 우선 공통코드(common), 고객센터(contact) 서비스 부터 개발에 들어갔습니다.</li>
  <li>공통코드는 이미 입력된 코드들만 출력해주면 되고, 고객센터는 구색맞추기용으로 넣어놓았기 때문에 기능이 많지 않습니다.</li>
</ul>

<h2 id="0-후기">0. 후기</h2>

<hr />

<ul>
  <li>
    <p>배운걸 토대로 common서비스, contact 서비스를 개발한 결과 느낀점을 적자면… 프레임워크의 기능이 정말 너무 강력하다는 것입니다.  <u>프레임워크에서 제공해주는 기본 기능만 사용한다면</u> 코드는 정말 몇 줄이면 끝납니다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c1">// 주소 - 시 도메인</span>
 <span class="nd">@Entity</span>
 <span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDR_SI"</span><span class="o">)</span> <span class="c1">// 테이블이름과 클래스 이름이 다를 경우 설정</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddrSi</span> <span class="o">{</span>
     <span class="nd">@Id</span>
     <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSIID"</span><span class="o">)</span>
     <span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiId</span><span class="o">;</span>
     <span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSINAME"</span><span class="o">)</span>
     <span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiName</span><span class="o">;</span>

     <span class="nd">@OneToMany</span>
     <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSIID"</span><span class="o">)</span> <span class="c1">// 실제 DB에서 key로 들어갈 것</span>
     <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">AddrGu</span><span class="o">&gt;</span> <span class="n">gu</span><span class="o">;</span> <span class="c1">// 도메인 path로 들어갈 이름</span>

     <span class="c1">// getter/setter</span>
 <span class="o">}</span>
</code></pre></div>    </div>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 주소 - 시 Repository</span>
 <span class="nd">@RestResource</span><span class="o">(</span><span class="n">path</span><span class="o">=</span><span class="s">"si"</span><span class="o">,</span> <span class="n">rel</span><span class="o">=</span><span class="s">"si"</span><span class="o">)</span>
 <span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AddrSiRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">AddrSi</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
 <span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>저는 지금 REST 방식의 리소스를 제대로 이해하지 못해 버벅이고 있지만, REST 방식에 정통한 사람이 처음부터 리소스를 구성한다면 개발은 정말 순식간에 끝날 것 같습니다.</p>
  </li>
  <li>
    <p>CRUD중 CUD도 프레임워크가 알아서 구현해줘서 해당 요청을 막던가 권한 검사를 하던가 해야될 것 같습니다. (DELETE가 바로 되는걸 보고 섬짓했습니다.)</p>
  </li>
  <li>
    <p>프레임워크들이 개발자 대신 너무 많은 일을 해줘서 편하고 좋기도 하지만 한편으론 제가 이 프레임워크들을 모두 따라갈 수 있을지 걱정이 되기도 합니다.</p>
  </li>
</ul>

<h2 id="1-dependency">1. Dependency</h2>

<hr />

<ul>
  <li>
    <p>common 서비스와 contact 서비스는 아래의 Dependency를 사용했습니다.</p>

    <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependencies&gt;</span>
  <span class="c">&lt;!-- Spring Boot Starter Web --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
  
  <span class="c">&lt;!-- Spring Data - REST --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-rest<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>	
  
  <span class="c">&lt;!-- Spring Data JPA --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-jpa<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
  
  <span class="c">&lt;!-- 커넥션풀 라이브러리(보통 dbcp를 많이씀) --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.zaxxer<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>HikariCP<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
  
  <span class="c">&lt;!-- ojdbc 드라이버 --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.oracle<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>ojdbc6<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>11.2.0.3<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;/dependency&gt;</span>
  
  <span class="c">&lt;!-- Spring Boot 테스트 --&gt;</span>
  <span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
    <span class="nt">&lt;exclusions&gt;</span>
      <span class="nt">&lt;exclusion&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;/exclusion&gt;</span>
    <span class="nt">&lt;/exclusions&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="2-common-서비스">2. common 서비스</h2>

<hr />

<h3 id="21-호출-api">2.1. 호출 API</h3>

<ul>
  <li>
    <p>공통 코드를 관리하는 common 서비스에선 조회만 하면 됐기 때문에 아래와 같은 요청만 마련해뒀습니다.(POST, PUT, DELETE도 프레임워크 자체에서 구현해줬지만, 실제로 사용하는건 아래의 요청만 사용한다는 뜻입니다.)</p>

    <ul>
      <li>
        <p>GET /common/si 👉 전체 시 리스트</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"_embedded"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"si"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"addrSiId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SI00001"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"addrSiName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"서울"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"addrSi"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"gu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001/gu"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">:</span><span class="w">
    </span><span class="err">:</span><span class="w">
    </span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"addrSiId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SI00005"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"addrSiName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"광주"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00005"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"addrSi"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00005"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"gu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00005/gu"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"profile"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/profile/si"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
      </li>
      <li>
        <p>GET /common/si/{si} 👉 시 1개 상세사항 (아래는 {si}==”SI00001”)</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"addrSiId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"SI00001"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"addrSiName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"서울"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"addrSi"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"gu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001/gu"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
      </li>
      <li>
        <p>GET /common/si/{si}/gu  👉 시 1개의 구 전체 리스트 (아래는 {si}==”SI00001”)</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"_embedded"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"gu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"addrGuId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GU00023"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"addrGuName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"종로구"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00023"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"addrGu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00023"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="err">:</span><span class="w">
    </span><span class="err">:</span><span class="w">
    </span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"addrGuId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GU00009"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"addrGuName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"노원구"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00009"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"addrGu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00009"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/si/SI00001/gu"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
      </li>
      <li>
        <p>GET /common/si/{si}/gu/{gu} 👉 해당 시, 구에 대한 상세사항</p>

        <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"addrGuId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"GU00003"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"addrGuName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"강서구"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_links"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00003"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"addrGu"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8090/common/gu/GU00003"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>        </div>
      </li>
      <li>
        <p>다음 4개의 공통코드는 위 시/구와 다를게 없어서 결과는 생략합니다.</p>
      </li>
      <li>
        <p>GET /common/interest-main</p>
      </li>
      <li>
        <p>GET /common/interest-main/{interest-main}</p>
      </li>
      <li>
        <p>GET /common/interest-main/{interest-main}/interest-sub</p>
      </li>
      <li>
        <p>GET /common/interest-main/{interest-main}/interest-sub/{interest-sub}</p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="22-기록-사항">2.2. 기록 사항</h3>

<ul>
  <li>
    <p>Spring Boot, Spring Data에서 가장 기본이 되는 사항 외에, 다음에 개발할 때 사용할만한 것들을 기록해두겠습니다.</p>
  </li>
  <li>
    <p>테이블 조인 시키기 <code class="highlighter-rouge">@OneToMany</code>, <code class="highlighter-rouge">@JoinColumn</code></p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDR_SI"</span><span class="o">)</span> <span class="c1">// 테이블이름과 클래스 이름이 다를 경우 설정</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AddrSi</span> <span class="o">{</span>
  	
	<span class="nd">@Id</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSIID"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiId</span><span class="o">;</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSINAME"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">addrSiName</span><span class="o">;</span>
  	
	<span class="nd">@OneToMany</span>
	<span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ADDRSIID"</span><span class="o">)</span> <span class="c1">// 실제 DB에서 key로 들어갈 것</span>
	<span class="nc">Set</span><span class="o">&lt;</span><span class="nc">AddrGu</span><span class="o">&gt;</span> <span class="n">gu</span><span class="o">;</span> <span class="c1">// 도메인 path로 들어갈 이름</span>
  	
	<span class="cm">/**
	getter/setter
	**/</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Spring Data 조회 결과에 id 컬럼도 추가시키기(기본적으론 <code class="highlighter-rouge">@Id</code> 컬럼은 나오지 않습니다.)</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonConfiguration</span> <span class="kd">extends</span> <span class="nc">RepositoryRestConfigurerAdapter</span> <span class="o">{</span>
  
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">EntityManager</span> <span class="n">entityManager</span><span class="o">;</span>
  
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureRepositoryRestConfiguration</span><span class="o">(</span><span class="nc">RepositoryRestConfiguration</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">config</span><span class="o">.</span><span class="na">exposeIdsFor</span><span class="o">(</span><span class="n">entityManager</span><span class="o">.</span><span class="na">getMetamodel</span><span class="o">().</span><span class="na">getEntities</span><span class="o">().</span><span class="na">stream</span><span class="o">().</span><span class="na">map</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="n">e</span><span class="o">.</span><span class="na">getJavaType</span><span class="o">()).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">()).</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="nc">Class</span><span class="o">[</span><span class="mi">0</span><span class="o">]));</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// 출처 : https://stackoverflow.com/questions/30912826/expose-all-ids-when-using-spring-data-rest</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Spring Data JPA + Hibernate 에서 제공하는 기본쿼리가 아닌 다른 네이티브 쿼리 사용하기 (아래 두 메서드는 실제로 사용하는 메서드는 아닙니다.)</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestResource</span><span class="o">(</span><span class="n">path</span><span class="o">=</span><span class="s">"gu"</span><span class="o">,</span> <span class="n">rel</span><span class="o">=</span><span class="s">"gu"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">AddrGuRepository</span> <span class="kd">extends</span> <span class="nc">CrudRepository</span><span class="o">&lt;</span><span class="nc">AddrGu</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;{</span>
  	
	<span class="nd">@Query</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT ADDRGUID, ADDRGUNAME FROM ADDR_GU WHERE ADDRSIID=:si"</span><span class="o">,</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
	<span class="nc">List</span><span class="o">&lt;</span><span class="nc">AddrGu</span><span class="o">&gt;</span> <span class="nf">findBySiId</span><span class="o">(</span><span class="nc">String</span> <span class="n">si</span><span class="o">);</span>
  	
	<span class="nd">@Query</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT ADDRGUID, ADDRGUNAME FROM ADDR_GU WHERE ADDRSIID=:si AND ADDRGUID=:gu"</span><span class="o">,</span> <span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
	<span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">AddrGu</span><span class="o">&gt;</span> <span class="nf">findOneGu</span><span class="o">(</span><span class="nc">String</span> <span class="n">si</span><span class="o">,</span> <span class="nc">String</span> <span class="n">gu</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="3-contact-서비스">3. contact 서비스</h2>

<hr />

<ul>
  <li>고객센터(contact) 서비스는 사실 Sagyo 프로젝트에선 웹 서비스의 구색 맞추기용으로 넣어 놓은 서비스라 기능은 간단합니다.
    <ul>
      <li>자주 묻는 질문 READ</li>
      <li>공지사항 READ</li>
      <li>1:1 질문 CREATE</li>
    </ul>
  </li>
</ul>

<h3 id="31-페이징-정렬-조회">3.1. 페이징, 정렬 조회</h3>

<ul>
  <li>
    <p>자주 묻는 질문과 공지사항 조회는 게시일 역순, 10개씩 페이징 처리를 했습니다.</p>
  </li>
  <li>
    <p>Repository는 <code class="highlighter-rouge">CrudRepository</code>, <code class="highlighter-rouge">Repository</code>인터페이스를 확장한 <code class="highlighter-rouge">PagingAndSortingRepository</code> 인터페이스를 사용했습니다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestResource</span><span class="o">(</span><span class="n">path</span><span class="o">=</span><span class="s">"notice"</span><span class="o">,</span> <span class="n">rel</span><span class="o">=</span><span class="s">"notice"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">NoticeRepository</span> <span class="kd">extends</span> <span class="nc">PagingAndSortingRepository</span><span class="o">&lt;</span><span class="nc">Notice</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="c1">// 확장만 하면 기본 기능은 구현되니 코드 올리기도 민망합니다.</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="highlighter-rouge">@RepositoryRestController</code> 를 이용해 기존 Spring Data REST의 요청 경로를 덮어썼고, 요청 받는 메서드를 따로 만들고 해당 메서드 안에서 Pageable 객체를 구성한 뒤 <code class="highlighter-rouge">PagingAndSortingRepository</code>의 <code class="highlighter-rouge">findAll(Pageable)</code>을 사용했습니다.</p>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RepositoryRestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">NoticeController</span> 
<span class="o">{</span>
	<span class="nd">@Autowired</span>
	<span class="nc">NoticeRepository</span> <span class="n">noticeRepository</span><span class="o">;</span>
  	
	<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span><span class="o">=</span><span class="s">"/notice"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">)</span>
	<span class="kd">public</span> <span class="nd">@ResponseBody</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Notice</span><span class="o">&gt;</span> <span class="nf">findAllBySortAndPaging</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"page"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"0"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">pageNum</span><span class="o">)</span> 
    <span class="o">{</span>
        <span class="nc">Pageable</span> <span class="n">page</span> <span class="o">=</span> <span class="nc">PageRequest</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">pageNum</span><span class="o">),</span> <span class="mi">10</span><span class="o">,</span> <span class="nc">Sort</span><span class="o">.</span><span class="na">by</span><span class="o">(</span><span class="nc">Sort</span><span class="o">.</span><span class="na">Direction</span><span class="o">.</span><span class="na">DESC</span><span class="o">,</span> <span class="s">"noticeDate"</span><span class="o">));</span>
		<span class="k">return</span> <span class="n">noticeRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">(</span><span class="n">page</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>GET /contact/notice?page={pageNum} 👉 공지사항 조회(기본 0번 페이지, 10개)</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"content"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"제목"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"contents"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"내용"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noticeDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2020-04-18 00:00:00"</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"30"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"개인정보 처리방침 및 위치기반 서비스 이용약관 변경 안내"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"contents"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"안녕하세요, 회원님....동의한 것으로 간주됩니다."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noticeDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-06-11 00:00:00"</span><span class="w">
  </span><span class="p">}</span><span class="w">
   </span><span class="err">:</span><span class="w">
   </span><span class="err">:</span><span class="w">
  </span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"23"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"3월 20일 (수) 사교 웹사이트 업데이트 안내"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"contents"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"안녕하세요 회원님...업데이트 될 예정입니다!"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"noticeDate"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-03-20 00:00:00"</span><span class="w">
  </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="nl">"pageable"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"sort"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"sorted"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"unsorted"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"empty"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"offset"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"pageNumber"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"pageSize"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nl">"paged"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"unpaged"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"totalElements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="p">,</span><span class="w">
  </span><span class="nl">"last"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nl">"totalPages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nl">"size"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"number"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"sort"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"sorted"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"unsorted"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"empty"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"first"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"numberOfElements"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
  </span><span class="nl">"empty"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>자주 묻는 질문 조회는 공지사항 조회와 동일하므로 생략합니다.</p>
  </li>
</ul>

<h3 id="32-11-질문-입력">3.2. 1:1 질문 입력</h3>

<ul>
  <li>
    <p>Spring Data JPA에서 CREATE는 <code class="highlighter-rouge">Repository</code> 인터페이스의 Save 메서드를 이용합니다.</p>
  </li>
  <li>
    <p>기존 1:1 질문 입력에선 id는 시퀀스를, 질문 일자는 SYSDATE를 이용했습니다. 시퀀스와 SYSDATE는 도메인 클래스를 만들 때 어노테이션들을 설정해주면 쉽게 가능합니다.(하지만 쉬운 방법을 찾는데 꽤 많은 시간을 썼습니다.. 😥)</p>

    <ul>
      <li>엔터티 클래스에 <code class="highlighter-rouge">@SequenceGenerator</code>를 추가합니다. <code class="highlighter-rouge">@SequenceGenerator</code>에서 sequenceName은 오라클 DB에서 사용하는 시퀀스 이름입니다.</li>
      <li>다음 id 필드에 <code class="highlighter-rouge">@GeneratedValue</code>를 추가합니다. <code class="highlighter-rouge">@GeneratedValue</code>에서 generator는 위에서 추가한 <code class="highlighter-rouge">@SequenceGenerator</code>의 name입니다.</li>
      <li>중요한건 strategy인데, 식별자를 어떻게 생성할지를 지정합니다.   AUTO, TABLE, SEQUENCE, IDENTITY 가 있습니다.
        <ul>
          <li>AUTO를 고르면 오라클, MySQL등 사용중인 DB에 따라 SEQUENCE, IDENTITY를 정합니다.</li>
          <li>TABLE은 식별키를 위한 테이블에서 키를 생성합니다.</li>
          <li>SEQUENCE는 오라클 등의 시퀀스</li>
          <li>IDENTITY는 Mysql 처럼 Auto-Increment 컬럼이 가능한 곳에 사용합니다.</li>
        </ul>
      </li>
      <li>날짜에 SYSDATE를 넣는건 테이블 컬럼에 DEFAULT SYSDATE가 걸려있기 때문에 directQuestionDate 속성에 insertable=false만 걸어서 INSERT 쿼리에서 빠지게 하였습니다.</li>
    </ul>

    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SequenceGenerator</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"DIRECT_QUESTION_SEQ_GENERATOR"</span>
				 <span class="o">,</span> <span class="n">sequenceName</span> <span class="o">=</span> <span class="s">"DIRECT_QUESTION_SEQ"</span>
				 <span class="o">,</span> <span class="n">allocationSize</span> <span class="o">=</span> <span class="mi">1</span><span class="o">)</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"DIRECT_QUESTION"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DirectQuestion</span> <span class="o">{</span>
	<span class="nd">@Id</span>
	<span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">SEQUENCE</span>
				  <span class="o">,</span> <span class="n">generator</span> <span class="o">=</span> <span class="s">"DIRECT_QUESTION_SEQ_GENERATOR"</span><span class="o">)</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"ID"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"TITLE"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"USERID"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">userId</span><span class="o">;</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"CONTENTS"</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">contents</span><span class="o">;</span>
	<span class="nd">@Column</span><span class="o">(</span><span class="n">name</span><span class="o">=</span><span class="s">"DIRECTQUESTIONDATE"</span>
		  <span class="o">,</span> <span class="n">insertable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
	<span class="kd">private</span> <span class="nc">String</span> <span class="n">directQuestionDate</span><span class="o">;</span> 
  	
	<span class="c1">// getter/setter</span>
  	
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>위의 설정을 했다면 POST 메서드로 Body에 JSON 데이터를 담아 요청을 보냅니다. Hibernate는 다음과 같은 쿼리를 수행하게 됩니다. 시퀀스가 설정 됐고,  directQuestionDate는 INSERT문에서 빠진 것을 볼 수 있습니다.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hibernate: select direct_question_seq.nextval from dual
Hibernate: insert into direct_question (contents, title, userid, id) values (?, ?, ?, ?)
</code></pre></div>    </div>
  </li>
  <li>
    <p>POST /direct-question 👉 1:1 질문 입력(아래는 JSON데이터를 담은 Body)</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nl">"title"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"title"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"userId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"b001"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"contents"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"contents~~"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>리턴 값</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w">
  </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"title"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b001"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"contents"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contents~~"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"directQuestionDate"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="nl">"_links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"self"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8010/contact/direct-question/21"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"directQuestion"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8010/contact/direct-question/21"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

    <ul>
      <li>directQuestionDate는 Hibernate에서 입력한게 아니기 때문에 null이 나오는데 DB에는 SYSDATE로 잘 들어가있습니다. DB자체에서 입력한 결과를 리턴값에 포함 시키는 방법을 본 것 같은데… 링크가 어딨더라..</li>
    </ul>
  </li>
</ul>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/posts/study/algorithm/binary-search/">
            알고리즘 - 이진탐색 문제풀이 잡기술
            <small>10 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/googling/etc/REST-API/">
            그런 REST API로 괜찮은가
            <small>10 Jun 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/posts/study/algorithm/Kruskal/">
            알고리즘 - 크루스칼 알고리즘, Union-Find, 최소 신장 트리
            <small>09 Jun 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
